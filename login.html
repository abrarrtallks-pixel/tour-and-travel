<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex,nofollow">
  <title>Admin Login | Sun Seekers Travels</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>â˜€</text></svg>">
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<div id="toast-container" class="toast-container"></div>

<div class="admin-login">
  <div class="admin-login-card">
    <div class="admin-login-logo">
      <div class="admin-login-logo-icon">â˜€</div>
      <h1 class="admin-login-title">Admin Panel</h1>
      <p class="admin-login-sub">Sun Seekers Travels â€” Secure Login</p>
    </div>

    <div class="admin-login-error" id="login-error">
      âŒ Invalid credentials. Please try again.
    </div>

    <form id="login-form">
      <div class="admin-form-group">
        <label class="admin-form-label">Username</label>
        <input type="text" id="login-user" class="admin-form-control" placeholder="Enter username" autocomplete="username" required>
      </div>
      <div class="admin-form-group">
        <label class="admin-form-label">Password</label>
        <div style="position:relative;">
          <input type="password" id="login-pass" class="admin-form-control" placeholder="Enter password" autocomplete="current-password" required style="padding-right:48px;">
          <button type="button" id="toggle-pass" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;color:rgba(255,255,255,0.4);cursor:pointer;font-size:1rem;">ğŸ‘</button>
        </div>
      </div>
      <button type="submit" id="login-btn" class="admin-btn admin-btn-accent" style="width:100%;padding:14px;font-size:0.95rem;border-radius:10px;margin-top:8px;">
        <span id="login-btn-text">ğŸ”“ Login to Admin Panel</span>
        <span id="login-btn-loader" style="display:none;">Verifying...</span>
      </button>
    </form>

    <div style="margin-top:24px;padding-top:20px;border-top:1px solid rgba(255,255,255,0.06);">
      <p style="color:rgba(255,255,255,0.25);font-size:0.75rem;text-align:center;">
        Username: <strong style="color:rgba(255,255,255,0.5)">admin</strong> &nbsp;Â·&nbsp; Password: <strong style="color:rgba(255,255,255,0.5)">SunSeekersAdmin@2024</strong><br>
        <a href="../index.html" style="color:rgba(255,255,255,0.25);text-decoration:none;margin-top:6px;display:inline-block;">â† Back to Website</a>
      </p>
    </div>
  </div>
</div>

<script>
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('keydown', e => {
  if (e.key==='F12' || (e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key))) e.preventDefault();
});

// â”€â”€ YOUR APPS SCRIPT URL â€” PRE-FILLED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyWEl6ywIhI5ZXK64ywhax3S6rzlh99wQmD9EhwfzYGrLBe_mItt-Wt3V08A--6hNg/exec';

document.getElementById('toggle-pass').addEventListener('click', function() {
  const i = document.getElementById('login-pass');
  i.type = i.type === 'password' ? 'text' : 'password';
});

document.getElementById('login-form').addEventListener('submit', async function(e) {
  e.preventDefault();
  const username = document.getElementById('login-user').value.trim();
  const password = document.getElementById('login-pass').value;
  const btn      = document.getElementById('login-btn');
  const btnText  = document.getElementById('login-btn-text');
  const btnLoad  = document.getElementById('login-btn-loader');
  const errEl    = document.getElementById('login-error');

  btn.disabled = true;
  btnText.style.display = 'none';
  btnLoad.style.display = 'inline';
  errEl.classList.remove('show');

  let ok = false;

  // 1. Try Apps Script login
  try {
    const res  = await fetch(`${APPS_SCRIPT_URL}?action=login&user=${encodeURIComponent(username)}&pass=${encodeURIComponent(password)}`);
    const data = await res.json();
    if (data.success) {
      sessionStorage.setItem('sst_admin', JSON.stringify({ user: username, token: data.token, time: Date.now() }));
      ok = true;
    }
  } catch(err) {
    console.log('Apps Script unreachable, trying local fallback');
  }

  // 2. Local fallback (same credentials as Code.gs)
  if (!ok) {
    await new Promise(r => setTimeout(r, 600));
    if (username === 'admin' && password === 'SunSeekersAdmin@2024') {
      sessionStorage.setItem('sst_admin', JSON.stringify({ user: username, token: 'local_' + Date.now(), time: Date.now() }));
      ok = true;
    }
  }

  if (ok) {
    window.location.href = 'dashboard.html';
    return;
  }

  errEl.classList.add('show');
  btn.disabled = false;
  btnText.style.display = 'inline';
  btnLoad.style.display = 'none';
});
</script>
</body>
</html>
